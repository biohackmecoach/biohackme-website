<!DOCTYPE html>
<html>
<head>
  <title>Test Firebase Function</title>
</head>
<body>
  <h1>Test Mailchimp Firebase Function</h1>
  <button id="testBtn">Test addToMailchimp Function</button>
  <pre id="result"></pre>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getFunctions, httpsCallable } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-functions.js';

    const firebaseConfig = {
      apiKey: "AIzaSyCztXlmtdV3n96hpNO1QsUc-vjd7CHR7Nw",
      authDomain: "biohackme-app-379de.firebaseapp.com",
      projectId: "biohackme-app-379de",
      storageBucket: "biohackme-app-379de.firebasestorage.app",
      messagingSenderId: "593310303438",
      appId: "1:593310303438:web:df5f2d44e0ea3ff7ce5609"
    };

    const app = initializeApp(firebaseConfig);
    const functions = getFunctions(app);

    document.getElementById('testBtn').addEventListener('click', async () => {
      const resultEl = document.getElementById('result');
      resultEl.textContent = 'Testing...';

      try {
        const addToMailchimp = httpsCallable(functions, 'addToMailchimp');

        const result = await addToMailchimp({
          email: 'test+firebase@example.com',
          firstName: 'Test',
          source: 'freebie-download'
        });

        resultEl.textContent = '✅ SUCCESS!\n\n' + JSON.stringify(result.data, null, 2);
        console.log('Success:', result);
      } catch (error) {
        resultEl.textContent = '❌ ERROR!\n\n' + error.message + '\n\nFull error:\n' + JSON.stringify(error, null, 2);
        console.error('Error:', error);
      }
    });
  </script>
</body>
</html>
